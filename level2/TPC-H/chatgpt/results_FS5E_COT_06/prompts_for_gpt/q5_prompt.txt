
You are a SQL expert.
The examples below show reasoning patterns and SQL queries.
Follow the same step-by-step thinking approach for the new question.
Return ONLY the SQL code without markdown formatting or explanations.


DATABASE SCHEMA:
Table customer(
  c_custkey integer,
  c_name character varying,
  c_address character varying,
  c_nationkey integer,
  c_phone character,
  c_acctbal numeric,
  c_mktsegment character,  -- Possible values: 'AUTOMOBILE', 'BUILDING', 'FURNITURE', 'MACHINERY', 'HOUSEHOLD'
  c_comment character varying
)

Table lineitem(
  l_orderkey integer,
  l_partkey integer,
  l_suppkey integer,
  l_linenumber integer,
  l_quantity numeric,
  l_extendedprice numeric,
  l_discount numeric,
  l_tax numeric,
  l_returnflag character,  -- Possible values: 'R' (Return), 'A' (Accept), 'N' (No return)
  l_linestatus character,  -- Possible values: 'O' (Open), 'F' (Filled)
  l_shipdate date,
  l_commitdate date,
  l_receiptdate date,
  l_shipinstruct character,  -- Possible values: 'DELIVER IN PERSON', 'COLLECT COD', 'NONE', 'TAKE BACK RETURN'
  l_shipmode character,  -- Possible values: 'AIR REG', 'AIR', 'RAIL', 'SHIP', 'TRUCK', 'MAIL', 'FOB'
  l_comment character varying
)

Table nation(
  n_nationkey integer,
  n_name character,   -- examples: 'ALGERIA', 'BRAZIL', 'CANADA', 'JAPAN', etc.
  n_regionkey integer,
  n_comment character varying
)

Table orders(
  o_orderkey integer,
  o_custkey integer,
  o_orderstatus character,  -- Possible values: 'O' (Open), 'F' (Filled), 'P' (Partial)
  o_totalprice numeric,
  o_orderdate date,
  o_orderpriority character,  -- Possible values: '1-URGENT', '2-HIGH', '3-MEDIUM', '4-NOT SPECIFIED', '5-LOW'
  o_clerk character,
  o_shippriority integer,
  o_comment character varying
)

Table part(
  p_partkey integer,
  p_name character varying,
  p_mfgr character,  
  p_brand character,  
  p_type character varying,  
  p_size integer,
  p_container character, 
  p_retailprice numeric,
  p_comment character varying
)

Table partsupp(
  ps_partkey integer,
  ps_suppkey integer,
  ps_availqty integer,
  ps_supplycost numeric,
  ps_comment character varying
)

Table region(
  r_regionkey integer,
  r_name character,  -- Possible values: 'AFRICA', 'AMERICA', 'ASIA', 'EUROPE', 'MIDDLE EAST'
  r_comment character varying
)

Table supplier(
  s_suppkey integer,
  s_name character varying,
  s_address character varying,
  s_nationkey integer,
  s_phone character,
  s_acctbal numeric,
  s_comment character varying
)

Here are some examples of questions with chain-of-thought reasoning and their SQL queries:

--- Example 1 ---
QUESTION:
This query determines the value of goods shipped between certain nations to help in the  re-negotiation of shipping 
contracts. 
The Volume  Shipping Query finds, for two given nations, the  gross discounted revenues derived from lineitems in which parts  were  shipped from a  supplier in either nation to a  customer in the  other nation during 1995 and 1996. The query lists the supplier nation, the customer nation, the year, and the revenue from shipments that took place  in that year. The query orders the answer by Supplier nation, Customer nation, and year (all ascending).
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. NATION1 is randomly selected within the list of values defined for N_NAME in Clause 4.2.3; In this case assume NATION1 'ARGENTINA'
2. NATION2 is randomly selected within the list of values defined for N_NAME in Clause 4.2.3 and must be different from the value selected for NATION1 in item 1 above. In this case assume NATION2 'KENYA'

CHAIN OF THOUGHT:
Let's think step by step.
According to "customer nation the", columns [customer.c_custkey] may be used.
According to "derived from lineitems in", columns [lineitem.l_extendedprice] may be used.
According to "from lineitems in", columns [lineitem.l_shipdate] may be used.
According to "lineitems in", columns [lineitem.l_discount, lineitem.l_orderkey, lineitem.l_suppkey] may be used.
According to "nation customer", columns [customer.c_nationkey] may be used.
According to "nation1 in", columns [nation.n_name, nation.n_nationkey] may be used.
According to "query orders", columns [orders.o_custkey, orders.o_orderkey] may be used.
According to "supplier in", columns [supplier.s_suppkey] may be used.
According to "supplier nation", columns [supplier.s_nationkey] may be used.
Values [1995-01-01, 1996-12-31, ARGENTINA, KENYA] may be used.
So the final answer is:

SQL QUERY:
select
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			extract(year from l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'ARGENTINA' and n2.n_name = 'KENYA')
				or (n1.n_name = 'KENYA' and n2.n_name = 'ARGENTINA')
			)
			and l_shipdate between date '1995-01-01' and date '1996-12-31'
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;

--- Example 2 ---
QUESTION:
This query finds which supplier should be selected to place an order for a given part in a given region.
The Minimum Cost Supplier Query finds, in a given region, for each part of a certain type and size, the supplier who can  supply  it  at  minimum  cost.  If  several  suppliers  in  that  region  offer  the  desired  part  type  and  size  at  the  same (minimum)  cost,  the  query  lists  the  parts  from  suppliers  with  the  100  highest  account  balances.  For  each  supplier, the  query  lists  the  supplier's  account  balance,  name  and  nation;  the  part's  number  and  manufacturer;  the  supplier's address, phone number and comment information.
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text:
1. SIZE is randomly selected within [1. 50]; In this case assume SIZE 2
2. TYPE is randomly selected within the list Syllable 3 defined for Types in Clause 4.2.2.13; In this case assume type '%TIN'
3. REGION is randomly selected within the list of values defined for R_NAME in 4.2.3. In this case assume REGION 'ASIA'

CHAIN OF THOUGHT:
Let's think step by step.
According to "cost supplier query finds", columns [partsupp.ps_supplycost] may be used.
According to "nation the", columns [nation.n_name, nation.n_nationkey] may be used.
According to "part in", columns [part.p_partkey, partsupp.ps_partkey] may be used.
According to "part s number", columns [part.p_mfgr, partsupp.ps_suppkey] may be used.
According to "part type", columns [part.p_type] may be used.
According to "part type and size", columns [part.p_size] may be used.
According to "region for", columns [nation.n_regionkey, region.r_name] may be used.
According to "region the", columns [region.r_regionkey] may be used.
According to "supplier s", columns [supplier.s_acctbal, supplier.s_comment, supplier.s_name, supplier.s_nationkey, supplier.s_suppkey] may be used.
According to "supplier s address", columns [supplier.s_address] may be used.
According to "supplier s address phone", columns [supplier.s_phone] may be used.
Values [%TIN, 2, ASIA] may be used.
So the final answer is:

SQL QUERY:
select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 2
	and p_type like '%TIN'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'ASIA'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'ASIA'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
limit 100;

--- Example 3 ---
QUESTION:
This query determines how the market share of a given nation within a given region has changed over two years  for a given part type.
The  market  share  for  a  given  nation  within  a  given  region  is  defined  as  the  fraction  of  the  revenue,  the  sum  of [l_extendedprice * (1-l_discount)], from the products of a specified type in that region that was supplied by suppliers from the given nation. The query determines this for the years 1995 and 1996 presented in this order.
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. NATION is randomly selected within the list of values defined for N_NAME in Clause 4.2.3; In this case assume NATION 'KENYA'
2. REGION is the value defined in Clause 4.2.3 for R_NAME where R_REGIONKEY corresponds to N_REGIONKEY for the selected NATION in item 1 above; In this case assume REGION 'AFRICA'
3. TYPE is randomly selected within the list of 3-syllable strings defined for Types in Clause 4.2.2.13. In this case assume TYPE 'ECONOMY PLATED BRASS'

CHAIN OF THOUGHT:
Let's think step by step.
According to "corresponds to n_regionkey", columns [customer.c_custkey] may be used.
According to "given part type", columns [lineitem.l_partkey, part.p_partkey, part.p_type] may be used.
According to "l_discount from the", columns [lineitem.l_discount] may be used.
According to "nation the", columns [nation.n_name, nation.n_nationkey] may be used.
According to "of l_extendedprice", columns [lineitem.l_extendedprice] may be used.
According to "r_name where r_regionkey corresponds", columns [region.r_name] may be used.
According to "r_regionkey corresponds to", columns [region.r_regionkey] may be used.
According to "suppliers from the given", columns [supplier.s_nationkey, supplier.s_suppkey] may be used.
According to "this order", columns [lineitem.l_orderkey, orders.o_custkey, orders.o_orderdate, orders.o_orderkey] may be used.
According to "to n_regionkey", columns [customer.c_nationkey, nation.n_regionkey] may be used.
Values [1995-01-01, 1996-12-31, AFRICA, ECONOMY PLATED BRASS, KENYA] may be used.
So the final answer is:

SQL QUERY:
select
	o_year,
	sum(case
		when nation = 'KENYA' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'AFRICA'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date '1995-01-01' and date '1996-12-31'
			and p_type = 'ECONOMY PLATED BRASS'
	) as all_nations
group by
	o_year
order by
	o_year;

--- Example 4 ---
QUESTION:
This  query  quantifies  the  amount  of  revenue  increase  that  would  have  resulted  from  eliminating  certain  company-wide discounts in a given percentage range in a given year. Asking this type of "what if" query can be used to look for ways to increase revenues.
The Forecasting Revenue Change Query considers all the lineitems shipped in a given year with discounts between DISCOUNT-0.01  and  DISCOUNT+0.01.  The  query  lists  the  amount  by  which  the  total  revenue  would  have increased  if  these  discounts  had  been  eliminated  for  lineitems  with  l_quantity  less  than  quantity.  Note  that  the potential revenue increase is equal to the sum of [l_extendedprice * l_discount] for all lineitems with discounts and quantities in the qualifying range.
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. DATE is the first of January of a randomly selected year within [1993 .. 1997]; In this case assume DATE '1994-01-01'
2. DISCOUNT is randomly selected within [0.02 .. 0.09]; In this case assume DISCOUNT 0.02
3. QUANTITY is randomly selected within [24 .. 25]. In this case assume QUANTITY 25

CHAIN OF THOUGHT:
Let's think step by step.
According to "l_discount for all lineitems", columns [lineitem.l_discount] may be used.
According to "lineitems shipped in", columns [lineitem.l_shipdate] may be used.
According to "lineitems with l_quantity", columns [lineitem.l_quantity] may be used.
According to "of l_extendedprice", columns [lineitem.l_extendedprice] may be used.
Values [0.01, 0.02, 1, 1994-01-01, 25] may be used.
So the final answer is:

SQL QUERY:
select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= date '1994-01-01'
	and l_shipdate < date '1994-01-01' + interval '1' year
	and l_discount between 0.02 - 0.01 and 0.02 + 0.01
	and l_quantity < 25;

--- Example 5 ---
QUESTION:
The  Large  Volume  Customer  Query  ranks  customers  based  on  their  having  placed  a  large  quantity  order.  Large quantity orders are defined as those orders whose total quantity is above a certain level.
The Large Volume Customer Query finds a list of the top 100 customers who have ever placed large quantity orders. The query lists the customer name, customer key, the order key, date and total price and the quantity for the order. 
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. QUANTITY is randomly selected within [312..315]. In this case assume QUANTITY = 314

CHAIN OF THOUGHT:
Let's think step by step.
According to "customer key the", columns [customer.c_custkey] may be used.
According to "customer name customer", columns [customer.c_name] may be used.
According to "key the order key", columns [lineitem.l_orderkey] may be used.
According to "order key", columns [orders.o_custkey, orders.o_orderkey] may be used.
According to "order key date", columns [orders.o_orderdate] may be used.
According to "orders whose total", columns [orders.o_totalprice] may be used.
According to "text 1 quantity is", columns [lineitem.l_quantity] may be used.
Values [314] may be used.
So the final answer is:

SQL QUERY:
select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 314
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
limit 100;

--- Your Task ---
QUESTION:
This query lists the revenue volume done through local suppliers.
The Local Supplier Volume Query lists for each nation in a region the revenue  volume that resulted from lineitem transactions  in  which  the  customer  ordering  parts  and  the  supplier  filling  them  were  both  within  that  nation.  The query is run in order to determine whether to institute local distribution centers in a given region. The query considers only parts ordered in a given  year. The  query displays  the  nations and revenue  volume  in descending order by revenue. Revenue volume for all qualifying lineitems in a particular nation is defined as sum(l_extendedprice * (1  - l_discount)).
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. REGION is randomly selected within the list of values defined for R_NAME in C;aise 4.2.3; In this case assume REGION 'EUROPE'
2. DATE is the first of January of a randomly selected year within [1993 .. 1997]. In this case assume 1994-01-01'

Think step by step and then return ONLY the SQL query:
