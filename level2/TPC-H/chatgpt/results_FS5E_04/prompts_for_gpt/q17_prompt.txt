
You are a SQL expert.
The examples below show SQL patterns, but DO NOT copy them literally.
Analyze the current question independently and create the most appropriate query.
Use example patterns only as inspiration, not as templates.
Return ONLY the SQL code without markdown formatting or explanations.


DATABASE SCHEMA:
Table customer(
  c_custkey integer,
  c_name character varying,
  c_address character varying,
  c_nationkey integer,
  c_phone character,
  c_acctbal numeric,
  c_mktsegment character,  -- Possible values: 'AUTOMOBILE', 'BUILDING', 'FURNITURE', 'MACHINERY', 'HOUSEHOLD'
  c_comment character varying
)

Table lineitem(
  l_orderkey integer,
  l_partkey integer,
  l_suppkey integer,
  l_linenumber integer,
  l_quantity numeric,
  l_extendedprice numeric,
  l_discount numeric,
  l_tax numeric,
  l_returnflag character,  -- Possible values: 'R' (Return), 'A' (Accept), 'N' (No return)
  l_linestatus character,  -- Possible values: 'O' (Open), 'F' (Filled)
  l_shipdate date,
  l_commitdate date,
  l_receiptdate date,
  l_shipinstruct character,  -- Possible values: 'DELIVER IN PERSON', 'COLLECT COD', 'NONE', 'TAKE BACK RETURN'
  l_shipmode character,  -- Possible values: 'AIR REG', 'AIR', 'RAIL', 'SHIP', 'TRUCK', 'MAIL', 'FOB'
  l_comment character varying
)

Table nation(
  n_nationkey integer,
  n_name character,   -- examples: 'ALGERIA', 'BRAZIL', 'CANADA', 'JAPAN', etc.
  n_regionkey integer,
  n_comment character varying
)

Table orders(
  o_orderkey integer,
  o_custkey integer,
  o_orderstatus character,  -- Possible values: 'O' (Open), 'F' (Filled), 'P' (Partial)
  o_totalprice numeric,
  o_orderdate date,
  o_orderpriority character,  -- Possible values: '1-URGENT', '2-HIGH', '3-MEDIUM', '4-NOT SPECIFIED', '5-LOW'
  o_clerk character,
  o_shippriority integer,
  o_comment character varying
)

Table part(
  p_partkey integer,
  p_name character varying,
  p_mfgr character,  
  p_brand character,  
  p_type character varying,  
  p_size integer,
  p_container character, 
  p_retailprice numeric,
  p_comment character varying
)

Table partsupp(
  ps_partkey integer,
  ps_suppkey integer,
  ps_availqty integer,
  ps_supplycost numeric,
  ps_comment character varying
)

Table region(
  r_regionkey integer,
  r_name character,  -- Possible values: 'AFRICA', 'AMERICA', 'ASIA', 'EUROPE', 'MIDDLE EAST'
  r_comment character varying
)

Table supplier(
  s_suppkey integer,
  s_name character varying,
  s_address character varying,
  s_nationkey integer,
  s_phone character,
  s_acctbal numeric,
  s_comment character varying
)

Here are some examples of questions and their corresponding SQL queries:

--- Example 1 ---
QUESTION:
The Discounted Revenue Query reports the gross discounted revenue attributed to the sale of selected parts handled in  a  particular  manner. This  query  is  an  example  of  code  such  as  might be  produced  programmatically  by  a  data mining tool.
The  Discounted  Revenue  query  finds  the  gross  discounted  revenue  for  all  orders  for three  different  types  of  parts that  were  shipped by air  and  delivered in person. Parts are selected based on the  combination of specific brands, a list of containers, and a range of sizes.
Substitution Parameters:
1. QUANTITY1 is randomly selected within [1..10]. In this case assume QUANTITY1 = 4
2. QUANTITY2 is randomly selected within [10..20]. In this case assume QUANTITY2 = 16
3. QUANTITY3 is randomly selected within [20..30]. In this case assume QUANTITY3 = 29
4. BRAND1, BRAND2, BRAND3 = 'Brand#MN' where each MN is a two character string representing two numbers randomly and independently selected within [1 .. 5]. In this case assume BRAND1 = 'Brand#11' , BRAND2 = 'Brand#25' , BRAND3 = 'Brand#54'

SQL QUERY:
select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#11'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 4 and l_quantity <= 4 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#25'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 16 and l_quantity <= 16 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#54'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 29 and l_quantity <= 29 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);

--- Example 2 ---
QUESTION:
This  query  finds  out  how  many  suppliers  can  supply  parts  with  given  attributes.  It  might  be  used,  for  example,  to 
determine whether there is a sufficient number of suppliers for heavily ordered parts. 
The Parts/Supplier Relationship Query counts the number of suppliers who can supply parts that satisfy a particular customer's requirements. The customer is interested in parts of eight different sizes as long as they are not of a given type, not of a given brand, and not from a supplier who has had complaints registered at the Better Business Bureau. Results must be presented in descending count and ascending brand, type, and size.
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. BRAND = Brand#MN where M and N are two single character strings representing two numbers randomly and independently selected within [1 .. 5]; In this case assume BRAND 'Brand#42'
2. TYPE is made of the  first 2 syllables of a string randomly selected within the list of 3-syllable strings defined for Types in Clause 4.2.2.13; In this case assume TYPE 'LARGE PLATED%'
3. SIZE1 is randomly selected as a set of eight different values within [1 .. 50]; In this case assume SIZE1 = 9
4. SIZE2 is randomly selected as a set of eight different values within [1 .. 50]; In this case assume SIZE2 = 7
5. SIZE3 is randomly selected as a set of eight different values within [1 .. 50]; In this case assume SIZE3 = 14
6. SIZE4 is randomly selected as a set of eight different values within [1 .. 50]; In this case assume SIZE4 = 41
7. SIZE5 is randomly selected as a set of eight different values within [1 .. 50]; In this case assume SIZE5 = 43
8. SIZE6 is randomly selected as a set of eight different values within [1 .. 50]; In this case assume SIZE6 = 38
9. SIZE7 is randomly selected as a set of eight different values within [1 .. 50]; In this case assume SIZE7 = 23
10. SIZE8 is randomly selected as a set of eight different values within [1 .. 50]. In this case assume SIZE8 = 34

SQL QUERY:
select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#42'
	and p_type not like 'LARGE PLATED%'
	and p_size in (9, 7, 14, 41, 43, 38, 23, 34)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;

--- Example 3 ---
QUESTION:
This query reports the amount of business that was billed, shipped, and returned. 
The Pricing Summary Report Query provides a summary pricing report for all lineitems shipped as of a given date. The  date  is  within  60  -  120  days  of  the  greatest  ship  date  contained  in  the  database.  The  query  lists  totals  for extended  price,  discounted  extended  price,  discounted  extended  price  plus  tax,  average  quantity,  average  extended price,  and  average  discount.  These  aggregates  are  grouped  by  RETURNFLAG  and  LINESTATUS,  and  listed  in  ascending  order  of  RETURNFLAG  and  LINESTATUS.  A  count  of  the  number  of  lineitems  in  each  group  is included. 
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text:  
1. DELTA is randomly selected within [60. 120]. In this case assume DELTA = '84 days'
Comment: 1998-12-01 is the highest possible ship date as defined in the database population. (This is ENDDATE - 30).  The  query  will  include  all  lineitems  shipped  before  this  date  minus  DELTA  days.  The  intent  is  to  choose DELTA so that between 95% and 97% of the rows in the table are scanned.

SQL QUERY:
select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '84 days'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;

--- Example 4 ---
QUESTION:
The Global Sales Opportunity Query identifies geographies where there are customers who may be likely to make a purchase.
This query counts how many customers within a specific range of country codes have not placed orders for 7 years but  who  have  a  greater  than  average  “positive”  account  balance.  It  also  reflects  the magnitude  of  that  balance. Country code is defined as the first two characters of c_phone. 
Substitution Parameters: 
1. I1 ... I7 are randomly selected without repetition from the possible values for Country code as defined in Clause 4.2.2.9. In this case assume ('30', '31', '28', '21', '26', '33', '10')

SQL QUERY:
select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('30', '31', '28', '21', '26', '33', '10')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('30', '31', '28', '21', '26', '33', '10')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;

--- Example 5 ---
QUESTION:
This query determines how well the order priority system is working and gives an assessment of customer satisfaction.
The Order Priority Checking Query counts the number of orders ordered in a given quarter of a given year in which at least one lineitem  was received by the  customer later than its committed date. The  query lists the  count of such orders for each order priority sorted in ascending priority order.
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. DATE  is  the  first  day  of  a  randomly  selected  month  between  the  first  month  of  1993  and  the  10th  month  of 1997. In this case assume date '1997-01-01'

SQL QUERY:
select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '3' month
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority;

--- Your Task ---
QUESTION:
This  query  determines  how  much  average  yearly  revenue  would  be  lost  if  orders  were  no longer  filled  for  small quantities of certain parts. This may reduce overhead expenses by concentrating sales on larger shipments.
The  Small-Quantity-Order  Revenue  Query  considers  parts  of  a  given  brand  and  with  a given  container  type  and determines the average lineitem quantity of such parts ordered for all orders (past and pending) in the 7 -year database. What would be the average yearly gross (undiscounted) loss in revenue if orders for these parts with a quantity of less than 20% of this average were no longer taken?
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. BRAND = 'Brand#MN' where MN is a  two character string representing two numbers randomly and independently selected within [1 .. 5]; In this case assume BRAND 'Brand#23'
2. CONTAINER  is  randomly  selected  within  the  list  of  2-syllable  strings  defined  for Containers  in  Clause 4.2.2.13. In this case assume CONTAINER 'SM CAN'

SQL QUERY:
