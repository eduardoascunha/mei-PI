
You are a SQL expert.
The examples below show SQL patterns, but DO NOT copy them literally.
Analyze the current question independently and create the most appropriate query.
Use example patterns only as inspiration, not as templates.
Return ONLY the SQL code without markdown formatting or explanations.


DATABASE SCHEMA:
Table customer(
  c_custkey integer,
  c_name character varying,
  c_address character varying,
  c_nationkey integer,
  c_phone character,
  c_acctbal numeric,
  c_mktsegment character,  -- Possible values: 'AUTOMOBILE', 'BUILDING', 'FURNITURE', 'MACHINERY', 'HOUSEHOLD'
  c_comment character varying
)

Table lineitem(
  l_orderkey integer,
  l_partkey integer,
  l_suppkey integer,
  l_linenumber integer,
  l_quantity numeric,
  l_extendedprice numeric,
  l_discount numeric,
  l_tax numeric,
  l_returnflag character,  -- Possible values: 'R' (Return), 'A' (Accept), 'N' (No return)
  l_linestatus character,  -- Possible values: 'O' (Open), 'F' (Filled)
  l_shipdate date,
  l_commitdate date,
  l_receiptdate date,
  l_shipinstruct character,  -- Possible values: 'DELIVER IN PERSON', 'COLLECT COD', 'NONE', 'TAKE BACK RETURN'
  l_shipmode character,  -- Possible values: 'AIR REG', 'AIR', 'RAIL', 'SHIP', 'TRUCK', 'MAIL', 'FOB'
  l_comment character varying
)

Table nation(
  n_nationkey integer,
  n_name character,   -- examples: 'ALGERIA', 'BRAZIL', 'CANADA', 'JAPAN', etc.
  n_regionkey integer,
  n_comment character varying
)

Table orders(
  o_orderkey integer,
  o_custkey integer,
  o_orderstatus character,  -- Possible values: 'O' (Open), 'F' (Filled), 'P' (Partial)
  o_totalprice numeric,
  o_orderdate date,
  o_orderpriority character,  -- Possible values: '1-URGENT', '2-HIGH', '3-MEDIUM', '4-NOT SPECIFIED', '5-LOW'
  o_clerk character,
  o_shippriority integer,
  o_comment character varying
)

Table part(
  p_partkey integer,
  p_name character varying,
  p_mfgr character,  
  p_brand character,  
  p_type character varying,  
  p_size integer,
  p_container character, 
  p_retailprice numeric,
  p_comment character varying
)

Table partsupp(
  ps_partkey integer,
  ps_suppkey integer,
  ps_availqty integer,
  ps_supplycost numeric,
  ps_comment character varying
)

Table region(
  r_regionkey integer,
  r_name character,  -- Possible values: 'AFRICA', 'AMERICA', 'ASIA', 'EUROPE', 'MIDDLE EAST'
  r_comment character varying
)

Table supplier(
  s_suppkey integer,
  s_name character varying,
  s_address character varying,
  s_nationkey integer,
  s_phone character,
  s_acctbal numeric,
  s_comment character varying
)

Here are some examples of questions and their corresponding SQL queries:

--- Example 1 ---
QUESTION:
This  query  quantifies  the  amount  of  revenue  increase  that  would  have  resulted  from  eliminating  certain  company-wide discounts in a given percentage range in a given year. Asking this type of "what if" query can be used to look for ways to increase revenues.
The Forecasting Revenue Change Query considers all the lineitems shipped in a given year with discounts between DISCOUNT-0.01  and  DISCOUNT+0.01.  The  query  lists  the  amount  by  which  the  total  revenue  would  have increased  if  these  discounts  had  been  eliminated  for  lineitems  with  l_quantity  less  than  quantity.  Note  that  the potential revenue increase is equal to the sum of [l_extendedprice * l_discount] for all lineitems with discounts and quantities in the qualifying range.
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. DATE is the first of January of a randomly selected year within [1993 .. 1997]; In this case assume DATE '1994-01-01'
2. DISCOUNT is randomly selected within [0.02 .. 0.09]; In this case assume DISCOUNT 0.02
3. QUANTITY is randomly selected within [24 .. 25]. In this case assume QUANTITY 25

SQL QUERY:
select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= date '1994-01-01'
	and l_shipdate < date '1994-01-01' + interval '1' year
	and l_discount between 0.02 - 0.01 and 0.02 + 0.01
	and l_quantity < 25;

--- Example 2 ---
QUESTION:
This query determines how much profit is made on a given line of parts, broken out by supplier nation and year.
The Product Type Profit Measure Query finds, for each nation and each year, the profit for all parts ordered in that year that contain a specified substring in their names and that were filled by a supplier in that nation. The profit is defined as the  sum of [(l_extendedprice*(1-l_discount))  -  (ps_supplycost  * l_quantity)] for all lineitems describing parts in the specified line. The query lists the nations in ascending alphabetical order and, for each nation, the  year 
and profit in descending order by year (most recent first).
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. COLOR is randomly selected within the list of values defined for the generation of P_NAME in Clause 4.2.3. In this case assume COLOR '%red%'

SQL QUERY:
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%red%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;

--- Example 3 ---
QUESTION:
This query reports the amount of business that was billed, shipped, and returned. 
The Pricing Summary Report Query provides a summary pricing report for all lineitems shipped as of a given date. The  date  is  within  60  -  120  days  of  the  greatest  ship  date  contained  in  the  database.  The  query  lists  totals  for extended  price,  discounted  extended  price,  discounted  extended  price  plus  tax,  average  quantity,  average  extended price,  and  average  discount.  These  aggregates  are  grouped  by  RETURNFLAG  and  LINESTATUS,  and  listed  in  ascending  order  of  RETURNFLAG  and  LINESTATUS.  A  count  of  the  number  of  lineitems  in  each  group  is included. 
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text:  
1. DELTA is randomly selected within [60. 120]. In this case assume DELTA = '84 days'
Comment: 1998-12-01 is the highest possible ship date as defined in the database population. (This is ENDDATE - 30).  The  query  will  include  all  lineitems  shipped  before  this  date  minus  DELTA  days.  The  intent  is  to  choose DELTA so that between 95% and 97% of the rows in the table are scanned.

SQL QUERY:
select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '84 days'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;

--- Example 4 ---
QUESTION:
This query determines how well the order priority system is working and gives an assessment of customer satisfaction.
The Order Priority Checking Query counts the number of orders ordered in a given quarter of a given year in which at least one lineitem  was received by the  customer later than its committed date. The  query lists the  count of such orders for each order priority sorted in ascending priority order.
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. DATE  is  the  first  day  of  a  randomly  selected  month  between  the  first  month  of  1993  and  the  10th  month  of 1997. In this case assume date '1997-01-01'

SQL QUERY:
select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= date '1997-01-01'
	and o_orderdate < date '1997-01-01' + interval '3' month
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority;

--- Example 5 ---
QUESTION:
The Global Sales Opportunity Query identifies geographies where there are customers who may be likely to make a purchase.
This query counts how many customers within a specific range of country codes have not placed orders for 7 years but  who  have  a  greater  than  average  “positive”  account  balance.  It  also  reflects  the magnitude  of  that  balance. Country code is defined as the first two characters of c_phone. 
Substitution Parameters: 
1. I1 ... I7 are randomly selected without repetition from the possible values for Country code as defined in Clause 4.2.2.9. In this case assume ('30', '31', '28', '21', '26', '33', '10')

SQL QUERY:
select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substring(c_phone from 1 for 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substring(c_phone from 1 for 2) in
				('30', '31', '28', '21', '26', '33', '10')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substring(c_phone from 1 for 2) in
						('30', '31', '28', '21', '26', '33', '10')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as custsale
group by
	cntrycode
order by
	cntrycode;

--- Your Task ---
QUESTION:
This query monitors the market response to a promotion such as TV advertisements or a special campaign.
The Promotion Effect Query determines what percentage of the revenue in a given year and month was derived from promotional parts. The query considers only parts actually shipped in that month and gives the percentage. Revenue is defined as (l_extendedprice * (1-l_discount)). 
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. DATE is the first day of a month randomly selected from a random year within [1993 .. 1997]. In this case assume DATE '1996-04-01'

SQL QUERY:
