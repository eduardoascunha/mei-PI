
You are a SQL expert.
The examples below show reasoning patterns and SQL queries.
Follow the same step-by-step thinking approach for the new question.
Return ONLY the SQL code without markdown formatting or explanations.


DATABASE SCHEMA:
Table customer(
  c_custkey integer,
  c_name character varying,
  c_address character varying,
  c_nationkey integer,
  c_phone character,
  c_acctbal numeric,
  c_mktsegment character,  -- Possible values: 'AUTOMOBILE', 'BUILDING', 'FURNITURE', 'MACHINERY', 'HOUSEHOLD'
  c_comment character varying
)

Table lineitem(
  l_orderkey integer,
  l_partkey integer,
  l_suppkey integer,
  l_linenumber integer,
  l_quantity numeric,
  l_extendedprice numeric,
  l_discount numeric,
  l_tax numeric,
  l_returnflag character,  -- Possible values: 'R' (Return), 'A' (Accept), 'N' (No return)
  l_linestatus character,  -- Possible values: 'O' (Open), 'F' (Filled)
  l_shipdate date,
  l_commitdate date,
  l_receiptdate date,
  l_shipinstruct character,  -- Possible values: 'DELIVER IN PERSON', 'COLLECT COD', 'NONE', 'TAKE BACK RETURN'
  l_shipmode character,  -- Possible values: 'AIR REG', 'AIR', 'RAIL', 'SHIP', 'TRUCK', 'MAIL', 'FOB'
  l_comment character varying
)

Table nation(
  n_nationkey integer,
  n_name character,   -- examples: 'ALGERIA', 'BRAZIL', 'CANADA', 'JAPAN', etc.
  n_regionkey integer,
  n_comment character varying
)

Table orders(
  o_orderkey integer,
  o_custkey integer,
  o_orderstatus character,  -- Possible values: 'O' (Open), 'F' (Filled), 'P' (Partial)
  o_totalprice numeric,
  o_orderdate date,
  o_orderpriority character,  -- Possible values: '1-URGENT', '2-HIGH', '3-MEDIUM', '4-NOT SPECIFIED', '5-LOW'
  o_clerk character,
  o_shippriority integer,
  o_comment character varying
)

Table part(
  p_partkey integer,
  p_name character varying,
  p_mfgr character,  
  p_brand character,  
  p_type character varying,  
  p_size integer,
  p_container character, 
  p_retailprice numeric,
  p_comment character varying
)

Table partsupp(
  ps_partkey integer,
  ps_suppkey integer,
  ps_availqty integer,
  ps_supplycost numeric,
  ps_comment character varying
)

Table region(
  r_regionkey integer,
  r_name character,  -- Possible values: 'AFRICA', 'AMERICA', 'ASIA', 'EUROPE', 'MIDDLE EAST'
  r_comment character varying
)

Table supplier(
  s_suppkey integer,
  s_name character varying,
  s_address character varying,
  s_nationkey integer,
  s_phone character,
  s_acctbal numeric,
  s_comment character varying
)

Here are some examples of questions with chain-of-thought reasoning and their SQL queries:

--- Example 1 ---
QUESTION:
This query determines whether selecting less expensive modes of shipping is negatively affecting the critical-priority orders by causing more parts to be received by customers after the committed date.
The Shipping Modes and Order Priority Query counts, by ship mode, for lineitems actually received by customers in 
a given year, the number of lineitems belonging to orders for which the l_receiptdate exceeds the l_commitdate for 
two  different  specified  ship  modes.  Only  lineitems  that  were  actually  shipped  before  the  l_commitdate  are  con-
sidered. The late lineitems are partitioned into two groups, those with priority URGENT or HIGH, and those with a 
priority other than URGENT.
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. SHIPMODE1 is randomly selected within the list of values defined for Modes in Clause 4.2.2.13; In this case assume SHIPMODE1 'FOB'
2. SHIPMODE2 is randomly selected within the list of values defined for Modes in  Clause  4.2.2.13 and must be different from the value selected for SHIPMODE1 in item 1; In this case assume SHIPMODE2 'MAIL'
3. DATE is the first of January of a randomly selected year within [1993 .. 1997]. In this case assume DATE '1996-01-01'

CHAIN OF THOUGHT:
Let's think step by step.
According to "belonging to orders for", columns [orders.o_orderkey] may be used.
According to "for lineitems actually received", columns [lineitem.l_shipdate] may be used.
According to "l_commitdate for", columns [lineitem.l_commitdate] may be used.
According to "l_receiptdate exceeds the", columns [lineitem.l_receiptdate] may be used.
According to "lineitems belonging to orders", columns [lineitem.l_orderkey] may be used.
According to "order priority query", columns [orders.o_orderpriority] may be used.
According to "ship mode for lineitems", columns [lineitem.l_shipmode] may be used.
Values [1, 1-URGENT, 1996-01-01, 2-HIGH, FOB, MAIL] may be used.
So the final answer is:

SQL QUERY:
select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('FOB', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= date '1996-01-01'
	and l_receiptdate < date '1996-01-01' + interval '1' year
group by
	l_shipmode
order by
	l_shipmode;

--- Example 2 ---
QUESTION:
This query reports the amount of business that was billed, shipped, and returned. 
The Pricing Summary Report Query provides a summary pricing report for all lineitems shipped as of a given date. The  date  is  within  60  -  120  days  of  the  greatest  ship  date  contained  in  the  database.  The  query  lists  totals  for extended  price,  discounted  extended  price,  discounted  extended  price  plus  tax,  average  quantity,  average  extended price,  and  average  discount.  These  aggregates  are  grouped  by  RETURNFLAG  and  LINESTATUS,  and  listed  in  ascending  order  of  RETURNFLAG  and  LINESTATUS.  A  count  of  the  number  of  lineitems  in  each  group  is included. 
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text:  
1. DELTA is randomly selected within [60. 120]. In this case assume DELTA = '84 days'
Comment: 1998-12-01 is the highest possible ship date as defined in the database population. (This is ENDDATE - 30).  The  query  will  include  all  lineitems  shipped  before  this  date  minus  DELTA  days.  The  intent  is  to  choose DELTA so that between 95% and 97% of the rows in the table are scanned.

CHAIN OF THOUGHT:
Let's think step by step.
According to "lineitems in", columns [lineitem.l_discount] may be used.
According to "lineitems shipped before", columns [lineitem.l_shipdate] may be used.
According to "linestatus and", columns [lineitem.l_linestatus] may be used.
According to "number of lineitems", columns [lineitem.l_quantity] may be used.
According to "of lineitems", columns [lineitem.l_tax] may be used.
According to "price discounted extended price", columns [lineitem.l_extendedprice] may be used.
According to "returnflag and linestatus a", columns [lineitem.l_returnflag] may be used.
Values [1998-12-01, 84 days] may be used.
So the final answer is:

SQL QUERY:
select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '84 days'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;

--- Example 3 ---
QUESTION:
The Discounted Revenue Query reports the gross discounted revenue attributed to the sale of selected parts handled in  a  particular  manner. This  query  is  an  example  of  code  such  as  might be  produced  programmatically  by  a  data mining tool.
The  Discounted  Revenue  query  finds  the  gross  discounted  revenue  for  all  orders  for three  different  types  of  parts that  were  shipped by air  and  delivered in person. Parts are selected based on the  combination of specific brands, a list of containers, and a range of sizes.
Substitution Parameters:
1. QUANTITY1 is randomly selected within [1..10]. In this case assume QUANTITY1 = 4
2. QUANTITY2 is randomly selected within [10..20]. In this case assume QUANTITY2 = 16
3. QUANTITY3 is randomly selected within [20..30]. In this case assume QUANTITY3 = 29
4. BRAND1, BRAND2, BRAND3 = 'Brand#MN' where each MN is a two character string representing two numbers randomly and independently selected within [1 .. 5]. In this case assume BRAND1 = 'Brand#11' , BRAND2 = 'Brand#25' , BRAND3 = 'Brand#54'

CHAIN OF THOUGHT:
Let's think step by step.
According to "brand 25 brand3", columns [part.p_brand] may be used.
According to "containers and", columns [part.p_container] may be used.
According to "discounted revenue query finds", columns [lineitem.l_discount] may be used.
According to "parts are selected based", columns [part.p_partkey] may be used.
According to "quantity1 is", columns [lineitem.l_quantity] may be used.
According to "selected parts handled in", columns [lineitem.l_partkey] may be used.
According to "sizes substitution parameters 1", columns [part.p_size] may be used.
Values [10, 15, 16, 29, 4, 5, AIR, AIR REG, Brand#11, Brand#25, Brand#54, DELIVER IN PERSON, LG BOX, LG CASE, LG PACK, LG PKG, MED BAG, MED BOX, MED PACK, MED PKG, SM BOX, SM CASE, SM PACK, SM PKG] may be used.
So the final answer is:

SQL QUERY:
select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#11'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 4 and l_quantity <= 4 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#25'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 16 and l_quantity <= 16 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#54'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 29 and l_quantity <= 29 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);

--- Example 4 ---
QUESTION:
The  Large  Volume  Customer  Query  ranks  customers  based  on  their  having  placed  a  large  quantity  order.  Large quantity orders are defined as those orders whose total quantity is above a certain level.
The Large Volume Customer Query finds a list of the top 100 customers who have ever placed large quantity orders. The query lists the customer name, customer key, the order key, date and total price and the quantity for the order. 
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. QUANTITY is randomly selected within [312..315]. In this case assume QUANTITY = 314

CHAIN OF THOUGHT:
Let's think step by step.
According to "customer key the", columns [customer.c_custkey] may be used.
According to "customer name customer", columns [customer.c_name] may be used.
According to "key the order key", columns [lineitem.l_orderkey] may be used.
According to "order key", columns [orders.o_custkey, orders.o_orderkey] may be used.
According to "order key date", columns [orders.o_orderdate] may be used.
According to "orders whose total", columns [orders.o_totalprice] may be used.
According to "text 1 quantity is", columns [lineitem.l_quantity] may be used.
Values [314] may be used.
So the final answer is:

SQL QUERY:
select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 314
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
limit 100;

--- Example 5 ---
QUESTION:
This query finds the most important subset of suppliers' stock in a given nation.
The Important Stock Identification Query finds, from scanning the available stock of suppliers in a given nation, all the parts that represent a significant 
percentage of the  total value of all available parts. The query displays the part number and the value of those parts in descending order of value.
Substitution Parameters: Values for the following substitution parameter must be generated and used to build the executable query text: 
1. NATION is randomly selected within the list of values defined for N_NAME in Clause 4.2.3; In this case assume NATION 'UNITED STATES'
2. FRACTION is chosen as 0.0001 / SF. In this case assume FRACTION 0.0001000000

CHAIN OF THOUGHT:
Let's think step by step.
According to "available parts the query", columns [partsupp.ps_availqty] may be used.
According to "nation the", columns [nation.n_name, nation.n_nationkey] may be used.
According to "of all available parts", columns [partsupp.ps_supplycost] may be used.
According to "of suppliers", columns [supplier.s_suppkey] may be used.
According to "parts in", columns [partsupp.ps_suppkey] may be used.
According to "query displays the part", columns [partsupp.ps_partkey] may be used.
According to "suppliers in", columns [supplier.s_nationkey] may be used.
Values [0.0001000000, UNITED STATES] may be used.
So the final answer is:

SQL QUERY:
select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0001000000
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'UNITED STATES'
		)
order by
	value desc;

--- Your Task ---
QUESTION:
This query retrieves the 10 unshipped orders with the highest value.
The Shipping Priority Query retrieves the shipping priority and potential revenue, defined as the sum of l_extendedprice * (1-l_discount), of the orders having the largest revenue among those that had not been shipped as of a given date. Orders are listed in decreasing order of revenue. If more than 10 unshipped orders exist, only the 10 orders with the largest revenue are listed.
Substitution Parameters: Values for the following substitution parameters must be generated and used to build the executable query text: 
1. SEGMENT is randomly selected within the list of values defined for Segments in Clause 4.2.2.13; In this case assume segment 'FURNITURE'
2. DATE is a randomly selected day within [1995-03-01 .. 1995-03-31]. In this case assume dates '1995-03-27', '1995-03-27'

Think step by step and then return ONLY the SQL query:
